@helper list(){
<div class="ct_list_wrap" sn-display="{{util.isTrue(data_baglist)}}">
    <ul class="ct_list">
        <li sn-repeat="item in data_baglist" class="ct_list_item" data-id="{{item.SPB_ID}}">
            <div class="ct_list_item_con">
                <img src="{{item.PRD_PIC}}" data-back="/item/{{item.PRD_ID}}" />
                <div class="con">
                    <b class="name">{{item.PRD_NAME}}</b>
                    <p class="size">尺寸：{{item.PRD_SPEC.split('|')[0]}}</p>
                    <p class="color">颜色：{{item.PRD_COLOR}}</p>
                    <p class="qty">
                        <span class="minus" sn-tap="item.SPB_QTY=Math.max(!item.SPB_QTY?1:(parseInt(item.SPB_QTY)-1),1)">-</span>
                        <input type="text" value="{{item.SPB_QTY||1}}" sn-model="item.SPB_QTY" />
                        <span class="plus" sn-tap="item.SPB_QTY=((parseInt(item.SPB_QTY)||1)+1)">+</span>
                    </p>
                </div>
                <div class="ft">
                    <b class="price">￥{{Math.round(item.PRD_PRICE*(item.SPB_QTY||1)*100)/100}}</b>
                    <del>￥{{Math.round(item.PRD_MEMBER_PRICE*(item.SPB_QTY||1)*100)/100}}</del>
                </div>
            </div>
        </li>
    </ul>
    <ul class="ct_list_info">
        <li><span>商品总价</span><em><b class="price">￥{{prod_amount}}</b></em></li>
        <li class="link js_use_coupon"><span>使用优惠券</span><em sn-display="{{couponcode.CSV_CODE}}">-<b>¥{{couponcode.VCA_DEDUCT_AMOUNT}}</b></em><em sn-display="{{!couponcode.CSV_CODE}}"><b>{{couponCount||0}}</b>张可用</em></li>
        <li class="link js_use_point">
            <span>积分抵扣</span>
            <em sn-display="{{Points}}">-<b>¥{{Points/100}}</b></em>
            <em sn-display="{{!Points}}"><b>{{user.Points}}</b>积分可用</em>
        </li>
        <li class="link js_use_freecard"><span>运费</span><em sn-display="{{freecouponcode.CSV_CODE}}"><b>已选1张</b></em> <em sn-display="{{freeCount}}"><b>{{freeCount||0}}</b>张免邮卡可用</em><em sn-display="{{!freeCount}}"><b>¥{{freight}}</b></em></li>
        <li><span>总计</span><em><b class="price">￥{{Math.round(Math.max(bag_amount-(Points/100)-(couponcode.VCA_DEDUCT_AMOUNT||0)+(freecouponcode.CSV_CODE?0:freight),0)*100)/100}}</b></em></li>
    </ul>
</div>
<div class="my_nodata" sn-display="{{!loading&&util.isFalse(data_baglist)}}" style="display:none">
    <div class="icon"></div>
    <div class="text">您的购物车内还没有商品</div>
    <div class="btn" data-forward="/all?from=/cart">去逛逛吧</div>
</div>
}
<header>
    <div class="head_back" data-back="{{back}}"></div>
    <div class="head_title">{{title}}</div>
</header>
<div class="main">
    @this.helpers.list()
</div>
<footer class="ct_list_action">
    <div class="total">总计：<b>￥{{Math.round(Math.max(bag_amount-(Points/100)-(couponcode.VCA_DEDUCT_AMOUNT||0)+(freecouponcode.CSV_CODE?0:freight),0)*100) / 100}}</b></div>
    <div class="btn_buy js_buy">结 算</div>
</footer>
<div class="ct_coupon_wrap {{isShowCoupon?'':'out'}}" style="display:none">
    <div class="ct_coupon">
        <div class="ct_coupon_hd">选择优惠券</div>
        <div class="ct_coupon_use">
            <input type="text" placeholder="请输入券码" />
            <b class="btn">使用</b>
        </div>
        <div class="ct_coupon_list">
            <div class="hd">已有优惠券</div>
            <ul class="bd">
                <li sn-repeat="item in coupon|filter:couponType==4?item.VCA_VCT_ID==4:(item.VCA_VCT_ID!=4)" class="{{(item.VCA_VCT_ID == 4 ? 'free' : item.VCA_VCT_ID == 2 ? 'vct2' : item.VCA_VCT_ID == 5 ? 'vct5' : '') + (item.IsOverdue ? ' dis' : '')}}" sn-tap="this.useCoupon(item)">
                    <div class="price">{{util.currency(item.VCA_DEDUCT_AMOUNT,'')}}</div>
                    <div class="name">{{item.VCA_VCT_ID==4?'免邮卡':item.VCA_NAME}}</div>
                    <div class="time">有效期:{{item.IsOverdue?'已过期':(util.formatDate(item.CSV_START_DT,'yyyy/MM/dd')+'-'+util.formatDate(item.CSV_END_DT,'yyyy/MM/dd'))}}</div>
                </li>
                <div class="nodata">暂无优惠券</div>
            </ul>
        </div>
    </div>
</div>